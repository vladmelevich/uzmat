{% load static %}
{% load static_version %}
<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if edit_mode %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ{% else %}–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ{% endif %} ‚Äî Uzmat</title>
  <link rel="icon" type="image/svg+xml" href="{% static 'uzmat/logo-uzmat.svg' %}">
  {% include 'uzmat/theme-init.html' %}
  <link rel="stylesheet" href="{% static_version 'uzmat/styles.css' %}">
  <script defer src="{% static 'uzmat/app.js' %}"></script>
  {% include 'uzmat/toast-container.html' %}
  <script>
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
    document.addEventListener('DOMContentLoaded', function() {
      const adTypeSelect = document.getElementById('ad_type');
      if (!adTypeSelect) return;
      
      const equipmentFields = document.getElementById('equipment-fields');
      const serviceFields = document.getElementById('service-fields');
      const partsFields = document.getElementById('parts-fields');
      const priceTypeGroup = document.getElementById('price-type-group');
      const operatorGroup = document.getElementById('operator-group');
      const minOrderGroup = document.getElementById('min-order-group');
      const characteristicsGroup = document.getElementById('characteristics-group');

      if (!equipmentFields || !serviceFields || !partsFields || !priceTypeGroup || !operatorGroup || !minOrderGroup || !characteristicsGroup) {
        console.warn('–ù–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã –Ω–∞–π–¥–µ–Ω—ã');
        return;
      }

      function updateFormFields() {
        const selectedType = adTypeSelect.value;
        
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≥—Ä—É–ø–ø—ã –ø–æ–ª–µ–π
        if (equipmentFields) equipmentFields.style.display = 'none';
        if (serviceFields) serviceFields.style.display = 'none';
        if (partsFields) partsFields.style.display = 'none';
        if (characteristicsGroup) characteristicsGroup.style.display = 'none';
        if (operatorGroup) operatorGroup.style.display = 'none';
        if (minOrderGroup) minOrderGroup.style.display = 'none';
        if (priceTypeGroup) priceTypeGroup.style.display = 'none';

        // –£–±–∏—Ä–∞–µ–º required —Å–æ –≤—Å–µ—Ö –ø–æ–ª–µ–π
        const allFields = document.querySelectorAll('.ad-type-fields input, .ad-type-fields textarea');
        allFields.forEach(field => field.removeAttribute('required'));

        if (selectedType === 'rent' || selectedType === 'sale') {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è –¥–ª—è —Ç–µ—Ö–Ω–∏–∫–∏
          if (equipmentFields) equipmentFields.style.display = 'block';
          if (characteristicsGroup) characteristicsGroup.style.display = 'block';
          
          // –î–æ–±–∞–≤–ª—è–µ–º required –æ–±—Ä–∞—Ç–Ω–æ
          if (equipmentFields) {
            equipmentFields.querySelectorAll('input[required], textarea[required]').forEach(field => {
              field.setAttribute('required', 'required');
            });
          }

          // –î–ª—è –∞—Ä–µ–Ω–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑
          if (selectedType === 'rent') {
            if (operatorGroup) operatorGroup.style.display = 'block';
            if (minOrderGroup) minOrderGroup.style.display = 'block';
          }

          // –¢–∏–ø —Ü–µ–Ω—ã –¥–ª—è –∞—Ä–µ–Ω–¥—ã –∏ –ø—Ä–æ–¥–∞–∂–∏
          if (priceTypeGroup) {
            if (selectedType === 'rent') {
              priceTypeGroup.style.display = 'block';
            } else if (selectedType === 'sale') {
              priceTypeGroup.style.display = 'none';
            }
          }
        } else if (selectedType === 'service') {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è –¥–ª—è —É—Å–ª—É–≥
          if (serviceFields) serviceFields.style.display = 'block';
          if (serviceFields) {
            serviceFields.querySelectorAll('input[required], textarea[required]').forEach(field => {
              field.setAttribute('required', 'required');
            });
          }
          if (priceTypeGroup) priceTypeGroup.style.display = 'none';
        } else if (selectedType === 'parts') {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è –¥–ª—è –∑–∞–ø—á–∞—Å—Ç–µ–π
          if (partsFields) partsFields.style.display = 'block';
          if (partsFields) {
            partsFields.querySelectorAll('input[required], textarea[required]').forEach(field => {
              field.setAttribute('required', 'required');
            });
          }
          if (priceTypeGroup) priceTypeGroup.style.display = 'block';
        }
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      updateFormFields();

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
      adTypeSelect.addEventListener('change', updateFormFields);
    });

    // –°–µ–ª–µ–∫—Ç–æ—Ä—ã —Å—Ç—Ä–∞–Ω—ã –∏ –≥–æ—Ä–æ–¥–∞ –≤ —Ñ–æ—Ä–º–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è
    document.addEventListener('DOMContentLoaded', function() {
      const countrySelector = document.getElementById('country_selector');
      if (!countrySelector) return;
      
      const countrySelect = document.getElementById('country_select');
      const countryToggle = countrySelector.querySelector('[data-filter-country-toggle]');
      const countryDropdown = countrySelector.querySelector('[data-filter-country-dropdown]');
      const countryDisplay = countrySelector.querySelector('[data-filter-country-display]');
      if (!countryDropdown) return;
      const countryOptions = countryDropdown.querySelectorAll('[data-filter-value]');
      
      const citySelector = document.getElementById('city_selector');
      if (!citySelector) return;
      
      const cityInput = document.getElementById('city_input');
      const cityToggle = citySelector.querySelector('[data-filter-city-toggle]');
      const cityDropdown = citySelector.querySelector('[data-filter-city-dropdown]');
      if (!cityDropdown) return;
      
      const citySearchInput = citySelector.querySelector('[data-filter-city-search]');
      const cityList = citySelector.querySelector('[data-filter-city-list]');
      const cityDisplay = citySelector.querySelector('[data-filter-city-display]');
      if (!cityList || !cityDisplay) return;

      // –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º
      const citiesByCountry = {
        kz: [
          "–ê–ª–º–∞—Ç—ã", "–ê—Å—Ç–∞–Ω–∞", "–®—ã–º–∫–µ–Ω—Ç", "–ö–∞—Ä–∞–≥–∞–Ω–¥–∞", "–ê–∫—Ç–æ–±–µ", "–¢–∞—Ä–∞–∑", "–ü–∞–≤–ª–æ–¥–∞—Ä",
          "–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫", "–°–µ–º–µ–π", "–ö–æ—Å—Ç–∞–Ω–∞–π", "–ö—ã–∑—ã–ª–æ—Ä–¥–∞", "–£—Ä–∞–ª—å—Å–∫", "–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫",
          "–ê—Ç—ã—Ä–∞—É", "–¢—É—Ä–∫–µ—Å—Ç–∞–Ω", "–ö–æ–∫—à–µ—Ç–∞—É", "–¢–µ–º–∏—Ä—Ç–∞—É", "–≠–∫–∏–±–∞—Å—Ç—É–∑", "–†—É–¥–Ω—ã–π", "–ñ–∞–Ω–∞–æ–∑–µ–Ω"
        ],
        uz: [
          "–¢–∞—à–∫–µ–Ω—Ç", "–°–∞–º–∞—Ä–∫–∞–Ω–¥", "–ù–∞–º–∞–Ω–≥–∞–Ω", "–ê–Ω–¥–∏–∂–∞–Ω", "–ù—É–∫—É—Å", "–ë—É—Ö–∞—Ä–∞", "–ö–∞—Ä—à–∏",
          "–§–µ—Ä–≥–∞–Ω–∞", "–ö–æ–∫–∞–Ω–¥", "–ú–∞—Ä–≥–∏–ª–∞–Ω", "–î–∂–∏–∑–∞–∫", "–ì—É–ª–∏—Å—Ç–∞–Ω", "–¢–µ—Ä–º–µ–∑", "–£—Ä–≥–µ–Ω—á",
          "–ù–∞–≤–æ–∏", "–ê–Ω–≥—Ä–µ–Ω", "–ß–∏—Ä—á–∏–∫", "–ë–µ–∫–∞–±–∞–¥", "–î–µ–Ω–∞—É", "–®–∞—Ö—Ä–∏—Å–∞–±–∑"
        ],
        ru: [
          "–ú–æ—Å–∫–≤–∞", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "–ö–∞–∑–∞–Ω—å", "–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥",
          "–ß–µ–ª—è–±–∏–Ω—Å–∫", "–°–∞–º–∞—Ä–∞", "–û–º—Å–∫", "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É", "–£—Ñ–∞", "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫", "–í–æ—Ä–æ–Ω–µ–∂",
          "–ü–µ—Ä–º—å", "–í–æ–ª–≥–æ–≥—Ä–∞–¥", "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä", "–°–∞—Ä–∞—Ç–æ–≤", "–¢—é–º–µ–Ω—å", "–¢–æ–ª—å—è—Ç—Ç–∏", "–ò–∂–µ–≤—Å–∫"
        ]
      };

      const countryNames = {
        kz: '–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω',
        uz: '–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω',
        ru: '–†–æ—Å—Å–∏—è'
      };

      let selectedCountry = '';
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
      window.selectedCountryValue = '';
      window.selectedCityValue = '';
      
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (–ø–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
      {% if edit_mode and ad.country %}
      const editCountry = '{{ ad.country }}';
      const editCity = '{{ ad.city }}';
      
      if (editCountry && countrySelect) {
        countrySelect.value = editCountry;
        selectedCountry = editCountry;
        window.selectedCountryValue = editCountry;
        if (countryDisplay) {
          countryDisplay.textContent = countryNames[editCountry] || '–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É';
        }
        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –æ–ø—Ü–∏—é
        countryOptions.forEach(opt => {
          if (opt.getAttribute('data-filter-value') === editCountry) {
            opt.classList.add('active');
          }
        });
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–æ—Ä–æ–¥–∞ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω—ã
        renderCities(editCountry);
      }
      
      if (editCity && cityInput) {
        cityInput.value = editCity;
        window.selectedCityValue = editCity;
        if (cityDisplay) {
          cityDisplay.textContent = editCity;
        }
      }
      {% endif %}

      // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≥–æ—Ä–æ–¥–∞
      function renderCities(country) {
        const cities = citiesByCountry[country] || [];
        cityList.innerHTML = "";
        
        cities.forEach((city) => {
          const item = document.createElement('button');
          item.type = 'button';
          item.className = 'uz-filter-option';
          item.textContent = city;
          item.addEventListener('click', (e) => {
            e.stopPropagation();
            cityDisplay.textContent = city;
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
            if (cityInput) {
              cityInput.value = city;
              cityInput.setAttribute('value', city);
              window.selectedCityValue = city;
              // –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—Ç—Ä–∏–±—É—Ç name –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏
              cityInput.name = 'city';
            }
            citySelector.removeAttribute('data-open');
            
            // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)
            console.log('–ì–æ—Ä–æ–¥ –≤—ã–±—Ä–∞–Ω:', city, '–ó–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–ª–µ:', cityInput ? cityInput.value : '–ø–æ–ª–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
          });
          cityList.appendChild(item);
        });
      }

      // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≥–æ—Ä–æ–¥–æ–≤
      function filterCities(query) {
        const items = cityList.querySelectorAll('.uz-filter-option');
        const lowerQuery = query.toLowerCase().trim();
        
        items.forEach((item) => {
          const cityName = item.textContent.toLowerCase();
          if (cityName.includes(lowerQuery)) {
            item.classList.remove('is-hidden');
          } else {
            item.classList.add('is-hidden');
          }
        });
      }

      // –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —Å—Ç—Ä–∞–Ω—ã
      if (countryToggle) {
        countryToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          const isOpen = countrySelector.hasAttribute('data-open');
          
          // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
          const pageSelectors = document.querySelectorAll('#country_selector[data-filter-country], #city_selector[data-filter-city]');
          pageSelectors.forEach(s => {
            s.removeAttribute('data-open');
          });
          
          if (!isOpen) {
            countrySelector.setAttribute('data-open', '');
          }
        });
      }

      // –í—ã–±–æ—Ä —Å—Ç—Ä–∞–Ω—ã
      if (countryOptions.length > 0) {
        countryOptions.forEach(option => {
          option.addEventListener('click', (e) => {
            e.stopPropagation();
            const value = option.getAttribute('data-filter-value');
            
            selectedCountry = value;
            window.selectedCountryValue = value;
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
            if (countrySelect) {
              countrySelect.value = value;
              countrySelect.setAttribute('value', value);
              // –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—Ç—Ä–∏–±—É—Ç name –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏
              countrySelect.name = 'country';
            }
            if (countryDisplay) countryDisplay.textContent = countryNames[value] || '–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤
            if (cityList && cityDisplay) {
              renderCities(value);
              cityDisplay.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥';
              if (cityInput) {
                cityInput.value = '';
                cityInput.removeAttribute('value');
              }
            }
            
            countryOptions.forEach(opt => opt.classList.remove('active'));
            option.classList.add('active');
            countrySelector.removeAttribute('data-open');
            
            // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)
            console.log('–°—Ç—Ä–∞–Ω–∞ –≤—ã–±—Ä–∞–Ω–∞:', value, '–ó–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–ª–µ:', countrySelect ? countrySelect.value : '–ø–æ–ª–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
          });
        });
      }

      // –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞
      if (cityToggle) {
        cityToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          const isOpen = citySelector.hasAttribute('data-open');
          
          // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
          const pageSelectors = document.querySelectorAll('#country_selector[data-filter-country], #city_selector[data-filter-city]');
          pageSelectors.forEach(s => {
            s.removeAttribute('data-open');
          });
          
          if (!isOpen) {
            if (selectedCountry) {
              renderCities(selectedCountry);
              citySelector.setAttribute('data-open', '');
              if (citySearchInput) {
                citySearchInput.value = '';
                setTimeout(() => citySearchInput.focus(), 100);
              }
            } else {
              alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É');
            }
          }
        });
      }

      // –ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–æ–≤
      if (citySearchInput) {
        citySearchInput.addEventListener('input', (e) => {
          filterCities(e.target.value);
        });
      }

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
      document.addEventListener('click', (e) => {
        const pageCountrySelector = document.getElementById('country_selector');
        const pageCitySelector = document.getElementById('city_selector');
        
        if (pageCountrySelector && pageCitySelector) {
          if (!e.target.closest('#country_selector') && !e.target.closest('#city_selector')) {
            pageCountrySelector.removeAttribute('data-open');
            pageCitySelector.removeAttribute('data-open');
          }
        }
      });
    });

    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.querySelector('.uz-form');
      if (!form) return;

      form.addEventListener('submit', function(e) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        const photoInput = document.getElementById('photo-upload');
        if (photoInput) {
          console.log('‚úì Input –Ω–∞–π–¥–µ–Ω, —Ñ–∞–π–ª–æ–≤:', photoInput.files ? photoInput.files.length : 0);
          if (photoInput.files && photoInput.files.length > 0) {
            console.log('‚úì –§–∞–π–ª –≥–æ—Ç–æ–≤ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ:', photoInput.files[0].name, '—Ä–∞–∑–º–µ—Ä:', photoInput.files[0].size, '—Ç–∏–ø:', photoInput.files[0].type);
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ input –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ñ–æ—Ä–º—ã
            if (!form.contains(photoInput)) {
              console.error('‚ö†Ô∏è Input —Ñ–∞–π–ª–∞ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ñ–æ—Ä–º—ã!');
              form.appendChild(photoInput);
            }
          } else {
            console.log('‚ö†Ô∏è –§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω - –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –±–µ–∑ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏');
          }
        } else {
          console.error('‚ö†Ô∏è Input —Ñ–∞–π–ª–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
        }
        
        const countrySelect = document.getElementById('country_select');
        const cityInput = document.getElementById('city_input');
        const adTypeSelect = document.getElementById('ad_type');
        
        // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –µ—Å–ª–∏ —Å–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–µ
        const countryDisplay = document.querySelector('[data-filter-country-display]');
        const cityDisplay = document.querySelector('[data-filter-city-display]');
        
        // –ü—ã—Ç–∞–µ–º—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–ª–∏ –∏–∑ DOM
        if (countrySelect && (!countrySelect.value || countrySelect.value.trim() === '')) {
          // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
          if (window.selectedCountryValue) {
            countrySelect.value = window.selectedCountryValue;
            countrySelect.setAttribute('value', window.selectedCountryValue);
            console.log('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:', window.selectedCountryValue);
          } else {
            // –ò—â–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –æ–ø—Ü–∏—é —Å—Ç—Ä–∞–Ω—ã
            const activeCountryOption = document.querySelector('#country_selector [data-filter-value].active');
            if (activeCountryOption) {
              const countryValue = activeCountryOption.getAttribute('data-filter-value');
              countrySelect.value = countryValue;
              countrySelect.setAttribute('value', countryValue);
              window.selectedCountryValue = countryValue;
              console.log('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–π –æ–ø—Ü–∏–∏:', countryValue);
            }
          }
        }
        
        if (cityInput && (!cityInput.value || cityInput.value.trim() === '')) {
          // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
          if (window.selectedCityValue) {
            cityInput.value = window.selectedCityValue;
            cityInput.setAttribute('value', window.selectedCityValue);
            console.log('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:', window.selectedCityValue);
          } else if (cityDisplay && cityDisplay.textContent && cityDisplay.textContent !== '–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥') {
            // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
            const cityValue = cityDisplay.textContent.trim();
            cityInput.value = cityValue;
            cityInput.setAttribute('value', cityValue);
            window.selectedCityValue = cityValue;
            console.log('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞:', cityValue);
          }
        }
        
        let errors = [];
        let hasErrors = false;

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        if (!adTypeSelect || !adTypeSelect.value) {
          errors.push('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ–±—ä—è–≤–ª–µ–Ω–∏—è');
          hasErrors = true;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä–∞–Ω—ã - –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏ –∑–Ω–∞—á–µ–Ω–∏–µ, –∏ —á—Ç–æ –ø–æ–ª–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        if (!countrySelect) {
          errors.push('–ü–æ–ª–µ –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
          hasErrors = true;
        } else if (!countrySelect.value || countrySelect.value.trim() === '') {
          errors.push('–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É');
          hasErrors = true;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ä–æ–¥–∞ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏ –∑–Ω–∞—á–µ–Ω–∏–µ, –∏ —á—Ç–æ –ø–æ–ª–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        if (!cityInput) {
          errors.push('–ü–æ–ª–µ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
          hasErrors = true;
        } else if (!cityInput.value || cityInput.value.trim() === '') {
          errors.push('–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥');
          hasErrors = true;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
        const adType = adTypeSelect ? adTypeSelect.value : '';
        if (adType === 'rent' || adType === 'sale') {
          const equipmentType = form.querySelector('[name="equipment_type"]');
          const brand = form.querySelector('[name="brand"]');
          const title = form.querySelector('[name="title"]');
          const description = form.querySelector('[name="description"]');
          
          if (equipmentType && !equipmentType.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ —Ç–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏');
            hasErrors = true;
          }
          if (brand && !brand.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –º–∞—Ä–∫—É');
            hasErrors = true;
          }
          if (title && !title.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è');
            hasErrors = true;
          }
          if (description && !description.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ');
            hasErrors = true;
          }
        } else if (adType === 'service') {
          const serviceName = form.querySelector('[name="service_name"]');
          const serviceDescription = form.querySelector('[name="service_description"]');
          
          if (serviceName && !serviceName.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏');
            hasErrors = true;
          }
          if (serviceDescription && !serviceDescription.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏');
            hasErrors = true;
          }
        } else if (adType === 'parts') {
          const partName = form.querySelector('[name="part_name"]');
          const partEquipmentType = form.querySelector('[name="part_equipment_type"]');
          const partBrand = form.querySelector('[name="part_brand"]');
          const partTitle = form.querySelector('[name="part_title"]');
          const partDescription = form.querySelector('[name="part_description"]');
          
          if (partName && !partName.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏');
            hasErrors = true;
          }
          if (partEquipmentType && !partEquipmentType.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ —Ç–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –∑–∞–ø—á–∞—Å—Ç–∏');
            hasErrors = true;
          }
          if (partBrand && !partBrand.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –º–∞—Ä–∫—É –¥–ª—è –∑–∞–ø—á–∞—Å—Ç–∏');
            hasErrors = true;
          }
          if (partTitle && !partTitle.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è');
            hasErrors = true;
          }
          if (partDescription && !partDescription.value.trim()) {
            errors.push('–£–∫–∞–∂–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ');
            hasErrors = true;
          }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–Ω—ã
        const price = form.querySelector('[name="price"]');
        if (price && !price.value.trim()) {
          errors.push('–£–∫–∞–∂–∏—Ç–µ —Ü–µ–Ω—É');
          hasErrors = true;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        const phone = form.querySelector('[name="phone"]');
        if (phone && !phone.value.trim()) {
          errors.push('–£–∫–∞–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω');
          hasErrors = true;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        const photoUpload = document.getElementById('photo-upload');
        if (photoUpload && photoUpload.files && photoUpload.files.length > 0) {
          console.log('–§–∞–π–ª –≤—ã–±—Ä–∞–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏:', photoUpload.files[0].name, '—Ä–∞–∑–º–µ—Ä:', photoUpload.files[0].size);
        } else {
          console.log('‚ö†Ô∏è –§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏');
        }
        
        // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        console.log('–ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Ñ–æ—Ä–º—ã:');
        console.log('–°—Ç—Ä–∞–Ω–∞:', countrySelect ? countrySelect.value : '–Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
        console.log('–ì–æ—Ä–æ–¥:', cityInput ? cityInput.value : '–Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
        console.log('–¢–∏–ø –æ–±—ä—è–≤–ª–µ–Ω–∏—è:', adType);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º FormData –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        const formData = new FormData(form);
        console.log('FormData keys:', Array.from(formData.keys()));
        if (photoUpload && photoUpload.files && photoUpload.files.length > 0) {
          console.log('‚úì –§–∞–π–ª –≤ FormData:', formData.has('photo'), '–∏–º—è:', photoUpload.files[0].name);
        } else {
          console.log('‚ö†Ô∏è –§–∞–π–ª –ù–ï –≤ FormData - input –ø—É—Å—Ç–æ–π');
        }

        // –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –§–ê–ô–õ–ê –ü–ï–†–ï–î –û–¢–ü–†–ê–í–ö–û–ô
        const finalPhotoCheck = document.getElementById('photo-upload');
        if (finalPhotoCheck) {
          if (finalPhotoCheck.files && finalPhotoCheck.files.length > 0) {
            console.log('‚úÖ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê: –§–∞–π–ª –≤—ã–±—Ä–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ:', finalPhotoCheck.files[0].name);
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —Ñ–∞–π–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤ —Ñ–æ—Ä–º–µ
            const finalFormData = new FormData(form);
            console.log('‚úÖ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê: FormData —Å–æ–¥–µ—Ä–∂–∏—Ç photo:', finalFormData.has('photo'));
            if (!finalFormData.has('photo')) {
              console.error('‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –§–∞–π–ª –≤—ã–±—Ä–∞–Ω, –Ω–æ –ù–ï –≤ FormData!');
              // –ü—ã—Ç–∞–µ–º—Å—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª
              finalFormData.append('photo', finalPhotoCheck.files[0]);
              console.log('–ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª –≤ FormData');
            }
          } else {
            console.log('‚ö†Ô∏è –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê: –§–∞–π–ª –ù–ï –≤—ã–±—Ä–∞–Ω');
          }
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏
        if (hasErrors && errors.length > 0) {
          e.preventDefault();
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –æ—à–∏–±–∫—É (–±–µ–∑ toast)
          alert(errors[0] || ('–ò—Å–ø—Ä–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –æ—à–∏–±–∫–∏:\n' + errors.join('\n')));
          // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–æ–ª—è
          if (!countrySelect || !countrySelect.value) {
            const countrySelector = document.getElementById('country_selector');
            if (countrySelector) {
              countrySelector.style.border = '2px solid var(--uz-danger)';
              setTimeout(() => {
                countrySelector.style.border = '';
              }, 3000);
            }
          }
          if (!cityInput || !cityInput.value) {
            const citySelector = document.getElementById('city_selector');
            if (citySelector) {
              citySelector.style.border = '2px solid var(--uz-danger)';
              setTimeout(() => {
                citySelector.style.border = '';
              }, 3000);
            }
          }
        }
      });
    });
  </script>
</head>

<body class="uz-body">

  <!-- Floating Header -->
  <header class="uz-header">
    <div class="uz-header-inner">
      <a href="{% url 'uzmat:index' %}" class="uz-logo">
        <img src="{% static 'uzmat/logo-uzmat.svg' %}" alt="Uzmat" class="uz-logo-mark">
        <span>Uzmat</span>
      </a>

      {% include 'uzmat/nav.html' %}

      <div class="uz-flex">
        {% include 'uzmat/country-selector.html' %}
        {% include 'uzmat/create-ad-button.html' %}
        <button class="uz-btn uz-btn-ghost uz-hidden-mobile" data-theme-toggle>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>
        {% include 'uzmat/user-avatar.html' %}
      </div>
    </div>
  </header>

  <main class="uz-container">

    <!-- Breadcrumbs -->
    <nav class="uz-breadcrumbs">
      <a href="{% url 'uzmat:index' %}">–ì–ª–∞–≤–Ω–∞—è</a>
      <span>/</span>
      <span>{% if edit_mode %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ{% else %}–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ{% endif %}</span>
    </nav>

    <div style="max-width: 800px; margin: 0 auto;">
      <h1 style="font-size: 32px; font-weight: 700; margin-bottom: 8px;">{% if edit_mode %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ{% else %}–°–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ{% endif %}</h1>
      <p style="font-size: 16px; color: var(--uz-text-dim); margin-bottom: 32px;">
        {% if edit_mode %}–ò–∑–º–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤–∞—à–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è{% else %}–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –æ –≤–∞—à–µ–π —Å–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫–µ, –∑–∞–ø—á–∞—Å—Ç—è—Ö –∏–ª–∏ —É—Å–ª—É–≥–∞—Ö{% endif %}
      </p>

      {% if messages %}
        <div style="margin-bottom: 24px;">
          {% for message in messages %}
            <div class="uz-alert" style="padding: 12px 16px; border-radius: var(--uz-radius-md); margin-bottom: 8px; 
              {% if message.tags == 'error' %}background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); color: var(--uz-danger);
              {% elif message.tags == 'success' %}background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); color: var(--uz-success);
              {% else %}background: var(--uz-bg-hover); border: 1px solid var(--uz-border);{% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <form class="uz-form" method="post" action="{% if edit_mode %}{% url 'uzmat:edit_ad' slug=ad.slug %}{% else %}{% url 'uzmat:create_ad' %}{% endif %}" enctype="multipart/form-data">
        {% csrf_token %}
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="uz-card" style="margin-bottom: 24px;">
          <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 24px;">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
          
          <div class="uz-form-group">
            <label class="uz-form-label">–¢–∏–ø –æ–±—ä—è–≤–ª–µ–Ω–∏—è *</label>
            <select class="uz-input" name="ad_type" id="ad_type" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
              <option value="rent" {% if edit_mode and ad.ad_type == 'rent' %}selected{% endif %}>–ê—Ä–µ–Ω–¥–∞</option>
              <option value="sale" {% if edit_mode and ad.ad_type == 'sale' %}selected{% endif %}>–ü—Ä–æ–¥–∞–∂–∞</option>
              <option value="service" {% if edit_mode and ad.ad_type == 'service' %}selected{% endif %}>–£—Å–ª—É–≥–∏</option>
              <option value="parts" {% if edit_mode and ad.ad_type == 'parts' %}selected{% endif %}>–ó–∞–ø—á–∞—Å—Ç–∏</option>
            </select>
          </div>

          <!-- –ü–æ–ª—è –¥–ª—è –ê—Ä–µ–Ω–¥—ã –∏ –ü—Ä–æ–¥–∞–∂–∏ -->
          <div id="equipment-fields" class="ad-type-fields">
            <div class="uz-form-group">
              <label class="uz-form-label">–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏ *</label>
              <input type="text" class="uz-input" name="equipment_type" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –≠–∫—Å–∫–∞–≤–∞—Ç–æ—Ä, –ü–æ–≥—Ä—É–∑—á–∏–∫" value="{% if edit_mode and ad.equipment_type %}{{ ad.equipment_type }}{% endif %}" required>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–ú–∞—Ä–∫–∞ *</label>
              <input type="text" class="uz-input" name="brand" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Komatsu, Caterpillar" value="{% if edit_mode and ad.brand %}{{ ad.brand }}{% endif %}" required>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–ú–æ–¥–µ–ª—å</label>
              <input type="text" class="uz-input" name="model" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: PC210, D6R" value="{% if edit_mode and ad.model %}{{ ad.model }}{% endif %}">
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞</label>
              <input type="number" class="uz-input" name="year" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 2022" min="1900" max="2025" value="{% if edit_mode and ad.year %}{{ ad.year }}{% endif %}">
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è *</label>
              <input type="text" class="uz-input" name="title" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ" value="{% if edit_mode and ad.title %}{{ ad.title }}{% endif %}" required>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
              <textarea class="uz-input" name="description" rows="6" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏, —É—Å–ª–æ–≤–∏–π –∞—Ä–µ–Ω–¥—ã/–ø—Ä–æ–¥–∞–∂–∏, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" required>{% if edit_mode and ad.description %}{{ ad.description }}{% endif %}</textarea>
            </div>
          </div>

          <!-- –ü–æ–ª—è –¥–ª—è –£—Å–ª—É–≥ -->
          <div id="service-fields" class="ad-type-fields" style="display: none;">
            <div class="uz-form-group">
              <label class="uz-form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ *</label>
              <input type="text" class="uz-input" name="service_name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –†–µ–º–æ–Ω—Ç —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä–æ–≤, –ê—Ä–µ–Ω–¥–∞ —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º" value="{% if edit_mode and ad.service_name %}{{ ad.service_name }}{% endif %}" required>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ *</label>
              <textarea class="uz-input" name="service_description" rows="6" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º–æ–π —É—Å–ª—É–≥–∏, —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Å—Ä–æ–∫–∏" required>{% if edit_mode and ad.description %}{{ ad.description }}{% endif %}</textarea>
            </div>
          </div>

          <!-- –ü–æ–ª—è –¥–ª—è –ó–∞–ø—á–∞—Å—Ç–µ–π -->
          <div id="parts-fields" class="ad-type-fields" style="display: none;">
            <div class="uz-form-group">
              <label class="uz-form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏ *</label>
              <input type="text" class="uz-input" name="part_name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì–∏–¥—Ä–æ—Ü–∏–ª–∏–Ω–¥—Ä, –§–∏–ª—å—Ç—Ä –º–∞—Å–ª—è–Ω—ã–π" value="{% if edit_mode and ad.part_name %}{{ ad.part_name }}{% endif %}" required>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–î–ª—è –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞ —Ç–µ—Ö–Ω–∏–∫–∏ *</label>
              <input type="text" class="uz-input" name="part_equipment_type" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –≠–∫—Å–∫–∞–≤–∞—Ç–æ—Ä, –ü–æ–≥—Ä—É–∑—á–∏–∫" value="{% if edit_mode and ad.part_equipment_type %}{{ ad.part_equipment_type }}{% endif %}" required>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–ú–∞—Ä–∫–∞ *</label>
              <input type="text" class="uz-input" name="part_brand" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Komatsu, Caterpillar" value="{% if edit_mode and ad.part_brand %}{{ ad.part_brand }}{% endif %}" required>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–ú–æ–¥–µ–ª—å</label>
              <input type="text" class="uz-input" name="part_model" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: PC210, D6R" value="{% if edit_mode and ad.part_model %}{{ ad.part_model }}{% endif %}">
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è *</label>
              <input type="text" class="uz-input" name="part_title" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏" value="{% if edit_mode and ad.title %}{{ ad.title }}{% endif %}" required>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
              <textarea class="uz-input" name="part_description" rows="6" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏, —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" required>{% if edit_mode and ad.description %}{{ ad.description }}{% endif %}</textarea>
            </div>
          </div>
        </div>

        <!-- –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã -->
        <div class="uz-card" style="margin-bottom: 24px;">
          <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 24px;">–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã</h2>
          
          <div class="uz-form-group">
            <label class="uz-form-label">–°—Ç—Ä–∞–Ω–∞ *</label>
            <div class="uz-filter-selector" id="country_selector" data-filter-country>
              <button type="button" class="uz-filter-button" data-filter-country-toggle>
                <span data-filter-country-display>–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É</span>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </button>
              <div class="uz-filter-dropdown" data-filter-country-dropdown>
                <button type="button" class="uz-filter-option" data-filter-value="kz">
                  <span style="font-size: 18px; margin-right: 8px;">üá∞üáø</span>
                  <span>–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</span>
                </button>
                <button type="button" class="uz-filter-option" data-filter-value="uz">
                  <span style="font-size: 18px; margin-right: 8px;">üá∫üáø</span>
                  <span>–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω</span>
                </button>
                <button type="button" class="uz-filter-option" data-filter-value="ru">
                  <span style="font-size: 18px; margin-right: 8px;">üá∑üá∫</span>
                  <span>–†–æ—Å—Å–∏—è</span>
                </button>
              </div>
              <input type="hidden" name="country" id="country_select" required>
            </div>
          </div>

          <div class="uz-form-group">
            <label class="uz-form-label">–ì–æ—Ä–æ–¥ *</label>
            <div class="uz-filter-selector" id="city_selector" data-filter-city>
              <button type="button" class="uz-filter-button" data-filter-city-toggle>
                <span data-filter-city-display>–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</span>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </button>
              <div class="uz-filter-dropdown" data-filter-city-dropdown>
                <input type="text" class="uz-filter-search" placeholder="–ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞..." data-filter-city-search>
                <div class="uz-filter-options-list" data-filter-city-list></div>
              </div>
              <input type="hidden" name="city" id="city_input" required>
            </div>
          </div>

          <div class="uz-form-group">
            <label class="uz-form-label">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
            <input type="tel" class="uz-input" name="phone" placeholder="+7 (XXX) XXX-XX-XX" value="{% if edit_mode and ad.phone %}{{ ad.phone }}{% elif user.phone %}{{ user.phone }}{% endif %}" required>
          </div>
        </div>

        <!-- –¶–µ–Ω–∞ –∏ —É—Å–ª–æ–≤–∏—è -->
        <div class="uz-card" style="margin-bottom: 24px;">
          <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 24px;">–¶–µ–Ω–∞ –∏ —É—Å–ª–æ–≤–∏—è</h2>
          
          <div class="uz-form-group">
            <label class="uz-form-label">–¶–µ–Ω–∞ *</label>
            <div class="uz-flex" style="gap: 12px;">
              <input type="number" class="uz-input" name="price" placeholder="–°—É–º–º–∞" value="{% if edit_mode and ad.price %}{{ ad.price|floatformat:0 }}{% endif %}" step="0.01" required style="flex: 1;">
              <select class="uz-input" name="currency" required style="width: 150px;">
                <option value="kzt" {% if edit_mode and ad.currency == 'kzt' %}selected{% endif %}>‚Ç∏ KZT</option>
                <option value="uzs" {% if edit_mode and ad.currency == 'uzs' %}selected{% endif %}>—Å—É–º UZS</option>
                <option value="rub" {% if edit_mode and ad.currency == 'rub' %}selected{% endif %}>‚ÇΩ RUB</option>
              </select>
            </div>
            <div style="font-size: 13px; color: var(--uz-text-dim); margin-top: 6px;">
              –¶–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ –¥–æ–ª–ª–∞—Ä—ã –°–®–ê –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞ –≤–º–µ—Å—Ç–µ —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∞–ª—é—Ç–æ–π
            </div>
          </div>

          <!-- –¢–∏–ø —Ü–µ–Ω—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –ê—Ä–µ–Ω–¥—ã, –ü—Ä–æ–¥–∞–∂–∏ –∏ –ó–∞–ø—á–∞—Å—Ç–µ–π) -->
          <div class="uz-form-group" id="price-type-group" style="display: none;">
            <label class="uz-form-label">–¢–∏–ø —Ü–µ–Ω—ã</label>
            <select class="uz-input" name="price_type" id="price_type">
              <option value="per-hour" {% if edit_mode and ad.price_type == 'per-hour' %}selected{% endif %}>–ó–∞ —á–∞—Å</option>
              <option value="per-day" {% if edit_mode and ad.price_type == 'per-day' %}selected{% endif %}>–ó–∞ –¥–µ–Ω—å</option>
              <option value="per-month" {% if edit_mode and ad.price_type == 'per-month' %}selected{% endif %}>–ó–∞ –º–µ—Å—è—Ü</option>
              <option value="fixed" {% if edit_mode and ad.price_type == 'fixed' %}selected{% endif %}>–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è</option>
            </select>
          </div>

          <!-- –û–ø–µ—Ä–∞—Ç–æ—Ä –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ (—Ç–æ–ª—å–∫–æ –¥–ª—è –ê—Ä–µ–Ω–¥—ã) -->
          <div class="uz-form-group" id="operator-group" style="display: none;">
            <label class="uz-form-label">
              <input type="checkbox" name="with_operator" id="with_operator" {% if edit_mode and ad.with_operator %}checked{% endif %} style="margin-right: 8px;">
              –° –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º / —ç–∫–∏–ø–∞–∂–µ–º
            </label>
          </div>

          <div class="uz-form-group" id="min-order-group" style="display: none;">
            <label class="uz-form-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑</label>
            <input type="text" class="uz-input" name="min_order" id="min_order" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 4 —á–∞—Å–∞, 1 –¥–µ–Ω—å" value="{% if edit_mode and ad.min_order %}{{ ad.min_order }}{% endif %}">
          </div>
        </div>

        <!-- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è -->
        <div class="uz-card" style="margin-bottom: 24px;">
          <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 24px;">–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h2>
          
          {% if edit_mode %}
          <!-- –¢–µ–∫—É—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
          {% if ad.image or ad.images.exists %}
          <div style="margin-bottom: 24px;">
            <div style="font-size: 13px; color: var(--uz-text-dim); margin-bottom: 12px; font-weight: 500;">–¢–µ–∫—É—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 12px;">
              {% if ad.image %}
              <div style="position: relative; border-radius: var(--uz-radius-md); overflow: hidden; border: 1px solid var(--uz-border);">
                <img src="{{ ad.image.url }}" alt="–û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" style="width: 100%; height: 150px; object-fit: cover; display: block;">
                <div style="position: absolute; top: 4px; left: 4px; background: rgba(0, 0, 0, 0.7); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 600;">–û—Å–Ω–æ–≤–Ω–æ–µ</div>
              </div>
              {% endif %}
              {% for img in ad.images.all %}
              <div style="position: relative; border-radius: var(--uz-radius-md); overflow: hidden; border: 1px solid var(--uz-border);">
                <img src="{{ img.image.url }}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ {{ forloop.counter }}" style="width: 100%; height: 150px; object-fit: cover; display: block;">
                {% if img.is_main %}
                <div style="position: absolute; top: 4px; left: 4px; background: rgba(16, 185, 129, 0.9); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 600;">–ì–ª–∞–≤–Ω–æ–µ</div>
                {% endif %}
              </div>
              {% endfor %}
            </div>
            <div style="margin-top: 12px; font-size: 12px; color: var(--uz-text-dim);">
              –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º
            </div>
          </div>
          {% endif %}
          {% endif %}
          
          <div class="uz-form-group">
            <label class="uz-form-label">{% if edit_mode %}–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ{% else %}–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ{% endif %}</label>
            <div class="uz-upload-area">
              <input type="file" id="photo-upload" name="photos" accept="image/*" multiple style="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0;">
              <label for="photo-upload" class="uz-upload-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 8px;">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="17 8 12 3 7 8"></polyline>
                  <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                <span>–ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª</span>
                <span style="font-size: 13px; color: var(--uz-text-muted); margin-top: 4px;">{% if edit_mode %}–ù–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º{% else %}–ú–∞–∫—Å–∏–º—É–º 10 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π{% endif %}</span>
                <span style="font-size: 12px; color: var(--uz-text-dim); margin-top: 2px; display: block;">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ —Ñ–æ—Ç–æ: 10 –ú–ë</span>
              </label>
            </div>
            <div id="photo-preview" class="uz-photo-preview"></div>
          </div>
        </div>

        <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –ê—Ä–µ–Ω–¥—ã –∏ –ü—Ä–æ–¥–∞–∂–∏) -->
        <div class="uz-card" id="characteristics-group" style="margin-bottom: 32px;">
          <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 24px;">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h2>
          
          <div class="uz-grid" style="grid-template-columns: repeat(2, 1fr); gap: 16px;">
            <div class="uz-form-group">
              <label class="uz-form-label">–ú–æ—â–Ω–æ—Å—Ç—å (–ª.—Å.)</label>
              <input type="number" class="uz-input" name="power" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 150" value="{% if edit_mode and ad.power %}{{ ad.power }}{% endif %}">
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–í–µ—Å (—Ç)</label>
              <input type="number" class="uz-input" name="weight" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 20" {% if edit_mode and ad.weight %}value="{{ ad.weight|stringformat:"g" }}"{% endif %} step="0.01">
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–°–æ—Å—Ç–æ—è–Ω–∏–µ</label>
              <select class="uz-input" name="condition">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                <option value="new" {% if edit_mode and ad.condition == 'new' %}selected{% endif %}>–ù–æ–≤–æ–µ</option>
                <option value="excellent" {% if edit_mode and ad.condition == 'excellent' %}selected{% endif %}>–û—Ç–ª–∏—á–Ω–æ–µ</option>
                <option value="good" {% if edit_mode and ad.condition == 'good' %}selected{% endif %}>–•–æ—Ä–æ—à–µ–µ</option>
                <option value="satisfactory" {% if edit_mode and ad.condition == 'satisfactory' %}selected{% endif %}>–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ</option>
              </select>
            </div>

            <div class="uz-form-group">
              <label class="uz-form-label">–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</label>
              <input type="number" class="uz-input" name="hours" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5000" value="{% if edit_mode and ad.hours %}{{ ad.hours }}{% endif %}">
            </div>
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="uz-flex" style="gap: 12px; justify-content: flex-end;">
          <a href="{% url 'uzmat:index' %}" class="uz-btn uz-btn-outline">–û—Ç–º–µ–Ω–∞</a>
          <button type="submit" class="uz-btn uz-btn-primary">
            {% if edit_mode %}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è{% else %}–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ{% endif %}
          </button>
        </div>
      </form>
    </div>

  </main>

  {% include 'uzmat/footer.html' %}

  <!-- Mobile Navigation -->
  <nav class="uz-bottom-nav uz-show-mobile">
    <a href="{% url 'uzmat:index' %}" class="uz-bottom-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
      <span>–ì–ª–∞–≤–Ω–∞—è</span>
    </a>
    <a href="{% url 'uzmat:chats' %}" class="uz-bottom-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
      <span>–ß–∞—Ç—ã</span>
    </a>
    <a href="{% url 'uzmat:create_ad' %}" class="uz-bottom-item" style="color: var(--uz-primary);">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="16"></line>
        <line x1="8" y1="12" x2="16" y2="12"></line>
      </svg>
      <span>–°–æ–∑–¥–∞—Ç—å</span>
    </a>
    {% if user.is_authenticated %}
    <a href="{% url 'uzmat:profile' %}" class="uz-bottom-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
      </svg>
      <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
    </a>
    {% else %}
    <a href="{% url 'uzmat:onboarding' %}" class="uz-bottom-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
      </svg>
      <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
    </a>
    {% endif %}
    <a href="{% url 'uzmat:settings' %}" class="uz-bottom-item">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round">
        <circle cx="12" cy="12" r="3"></circle>
        <path
          d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
        </path>
      </svg>
      <span>–ú–µ–Ω—é</span>
    </a>
  </nav>

</body>

</html>

